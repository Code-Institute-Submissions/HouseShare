{% extends 'base.html' %}
{% load home_extras %}
    {% load bootstrap_tags %}
    {% block content %}
    {% load staticfiles %}
    {% load assets_extras %}
        {% block head_style %}

        {% endblock %}
        <!-- Slider ============================================= -->
		<section id="slider" class="full-screen  slider-parallax">

			<div class="full-screen section nopadding nomargin noborder ohidden" style="background: url({% static 'myimages/ought5.jpg' %}) bottom center no-repeat; background-size: cover;">

				<div class="container dark" >
				    <div class="vertical-middle" >

				        <div id="section-about" class="page-section">

					        <div class="container clearfix">

                                <h2 data-animate="fadeInDown" class="divleft bottommargin font-body ls3" style="max-width: 700px;font-style: italic; font-size: 40px; font-family: 'Playfair Display';">Profile Settings</h2>

                                        <p data-animate="fadeInUp" class="lead divleft bottommargin" style="max-width: 700px; ">
                                            <span style="font-family: 'Playfair Display'">You are logged in as: </span>{{ user.first_name }} {{ user.last_name }} | {{ user.username }} </p>
                                            <p>

                                                <form role="form" method="post" action="">
                                                    {% csrf_token %}
                                                     {{ invitecodeform | as_bootstrap}}
                                                    <div class="form-group">
                                                        <button type="submit" class="btn btn-primary">Submit the Code</button>{% if code_message %}{{ code_message }}{% endif %}
                                                    </div>
                                                </form>



                                            <small>Something new to share? <button class="btn btn-primary">Yes! </button></small>
                                            </p>
                                        {% if assets %}
                                        <p> <span style="font-family: 'Playfair Display'">Your are sharing the following
                                            {%  with total=assets.count %}
                                                Asset{{ total|pluralize }}: </span>
                                            {%  endwith %}

                                                    {% for asset in assets %}




                                                                <p>

                                                                <div class="dropdown">

                                                                    <button class="btn btn-primary btn-lg btn-block dropdown-toggle" type="button" data-toggle="dropdown">
                                                                        {%  if asset.is_owner %}
                                                                        {{ asset.asset_ID.asset_display_name }} (Owner)
                                                                            {% else %}
                                                                            {{ asset.asset_ID.asset_display_name }}
                                                                        {%  endif %}
                                                                        <span class="caret"></span></button>

                                                                        <ul class="dropdown-menu">
                                                                            <li><a href="{% url 'asset_detail' asset.asset_ID_id %}">View Details</a></li>
                                                                            <li><a href="{% url 'all_future_asset_bookings_for_user' asset.asset_ID_id user.id %}">View My Bookings</a></li>
                                                                            <li><a href="{% url 'make_a_booking' asset.asset_ID_id %}">Make a Booking</a></li>
                                                                            <li><a href="{% url 'all_future_asset_bookings' asset.asset_ID_id %}">View All Bookings</a></li>
                                                                            <li><a href="{% url 'post_list' asset.asset_ID_id %}">{{ asset.asset_ID.asset_display_name }} Blog</a></li>
                                                                            <li><a href="{% url 'forum' asset.asset_ID_id %}">{{ asset.asset_ID.asset_display_name }} Forum</a></li>

                                                                            {%  if asset.is_owner %}
                                                                                <li><a href="">{{ asset.asset_ID.asset_display_name }} Pending Requests <span class="badge">{{ pending_requests|get_total_pending:asset.asset_ID }}</span></a></li>
                                                                            {%  endif %}



                                                                        </ul>

                                                                </div>
                                                                </p>



                                                    {% endfor %}


                                        </p>
                                        {% else %}
                                           <p>You are not linked to any assets</p>

                                        {% endif %}

                                        {% if bookings %}
                                        <p> <span style="font-family: 'Playfair Display'">You have requested the following
                                            {%  with total=bookings.count %}
                                                 Booking{{ total|pluralize }}: </span>
                                            {%  endwith %}
                                            <div class="col_half">
                                                <table class = "table table-striped">
                                                    <thead>
                                                        <tr>
                                                            <th>Name</th>
                                                            <th>From</th>
                                                            <th>Until</th>
                                                            <th>Confirmed?</th>
                                                            <th>Owner</th>
                                                            <th></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>

                                                        {% for booking in bookings %}
                                                            <tr>
                                                                <td>{{ booking.asset_ID.asset_display_name }}</td>
                                                                <td>{{ booking.start_date }}</td>
                                                                <td>{{ booking.end_date }}</td>
                                                                <td>{{ booking.is_confirmed }}</td>
                                                                <td>{{ booking.slot_owner_id.first_name }} {{ booking.slot_owner_id.last_name }}</td>
                                                                <td><a href="{% url 'booking_detail' booking.booking_id %}">View</a></td>

                                                            </tr>

                                                        {% endfor %}
                                                     </tbody>
                                                </table>
                                            </div>


                                        </p>
                                        {% else %}
                                            {% if assets.count > 0 %}
                                                You have no upcoming bookings <br>
                                                {% for asset in assets %}
                                                    <a href="{% url 'make_a_booking' asset.id %}" role="button" class = "btn btn-primary">Make a Booking | {{ asset.asset_ID.asset_display_name }}</a>
                                                {% endfor %}
                                            {% endif %}
                                        {% endif %}

                                        <div class="clear"></div>

                                        <div class="row topmargin-lg divcenter" style="max-width: 1000px;"></div>



				            </div>

                       </div>

					</div>
				</div>

			</div>

		</section> <!--#slider end -->



    {% endblock %}